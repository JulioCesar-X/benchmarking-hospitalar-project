<section class="forms-container">

    <div class="headingSection">
        <h2>Lista de atividades</h2>
        <img src="../../../assets/images/icons8-plus-30.png" class="icon" alt="createIcon" (click)="createActivity()">
    </div>

    <div *ngIf="isLoadingAtividades" class="loading-circle">
      <div class="spinner"></div>
      <p>A carregar atividades...</p>
    </div>

    <div *ngIf="!isLoadingAtividades" class="selectOptionContainer">
      <div class="selectOptionContainer--option __remove-paragraphMB">
        <p>Nome</p>
        <p>Opções</p>
      </div>
  
      <div *ngFor="let activity of activities; trackBy: trackByIndex"
        class="selectOptionContainer--option">
        <p>{{ activity.activity_name }}</p>
        <div>
          <img src="../../../assets/images/pencil-96.png" class="icon" alt="Edit" (click)="editActivity(activity)">
          <img src="../../../assets/images/trash-96.png" class="icon" alt="Delete" (click)="openModal('delete', activity)">
        </div>
      </div>
    </div>
  
    <mat-paginator class="mat-paginator" [length]="totalActivities" [pageSize]="pageSize" [pageSizeOptions]="[5, 10, 25, 100]"
      (page)="onPageChange($event)">
    </mat-paginator>
  </section>

  <!-- MODAL -->
  <div class="modal" [ngClass]="{'show': isModalOpen}" (click)="closeModal()">
    <div [class.loading]="isLoadingIndicadores">
        <div *ngIf="modalAction !== 'delete'" (click)="$event.stopPropagation()" class="modal-container" [ngClass]="{ 'forms-container__error': isError }">
            <div class="modalHeader">
              <h2 *ngIf="modalAction === 'create'" class="modalTitle">Criar atividade</h2>
              <h2 *ngIf="modalAction === 'edit'" class="modalTitle">Editar atividade</h2>
              <span class="close" (click)="closeModal()">&times;</span>
            </div>
          
            <div class="forms-container--inputContainer">
              <label>Nome atividade:</label>

              <input [(ngModel)]="selectedActivity" type="text" class="inputContainer--input" [ngClass]="{ 'inputContainer--input__error': isError }">
            </div>

            
            <div class="selectContainer">
              <label for="serviceId">Serviços:</label>
              <select id="serviceId" name="serviceId">
                <option *ngFor="let service of servicesList; let i = index;" [value]="service.id">
                  {{ service.service_name }}
                </option>
                <option *ngIf="isLoadingServices == true" disabled selected>A carregar serviços...</option>
                <option *ngIf="servicesList && servicesList.length === 0 && isLoadingServices == false" disabled>No services available</option>
              </select>
            </div>

            <div class="checkboxContainer">
              <h4 class="checkboxContainer-title">Associar indicadores:</h4>
        
              <div class="checkboxContainer--option" *ngFor="let indicator of indicatorsList; let i = index; trackBy: trackByIndex">
                <input class="styled-checkbox" type="checkbox"
                [checked]="isSelected(indicator.id)" 
                (click)="toggleSelection(indicator.id)">
                <label>{{ indicator.indicator_name }}</label>
              </div>


              <div *ngIf="isLoadingIndicadores" class="loading-circle">
                <div class="spinner"></div>
                <p>A carregar indicadores..</p>
              </div>
            </div>
          
            <button (click)="formSubmited()" type="submit" class="forms-Button">Confirmar</button>
        </div>


        <!-- Delete -->
        <div *ngIf="modalAction === 'delete'" class="modal-container" (click)="$event.stopPropagation()" [ngClass]="{ 'forms-container__error': isError }">
            <div class="modalHeader">
                <h2>Tem a certeza que quer remover esta atividade?</h2>
              <span class="close" (click)="closeModal()">&times;</span>
            </div>
          
            <button (click)="formSubmited()" type="submit" class="forms-Button">Confirmar</button>
        </div>
    </div>
  </div>


  