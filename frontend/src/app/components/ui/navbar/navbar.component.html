<div class="placeholder"></div> <!-- this element is used to ocupy some space in the DOM at the top for the Navbar -->

<div class="w-full fixed top-0 z-[1000] whiteBG whiteBorder">
  <header class="flex justify-between relative mb-auto max-w-full max-h-99">
    <div class="flex items-center gap-2 logoSection">
      <div class="">
        <img
          class="h-20 w-20 m-1"
          alt="SNS logo image"
          src="../../../../assets/images/novoLogo.png"
        />
      </div>

      <div class="">
        <h3 class="logoTxt darkBlueTxt">Unidade local de Saúde</h3>
        <h1 class="logoTxt darkBlueTxt">Tâmega e Sousa</h1>
      </div>
    </div>

    <div class="relative w-[35%] sm:w-[60%] z-[1] whiteTxt">
      <svg
        class="background-svg"
        xmlns="http://www.w3.org/2000/svg"
        version="1.1"
        width="100%"
        height="100%"
        viewBox="0 0 100 100"
        preserveAspectRatio="none"
      >
        <polygon points="0,100 10,0 100,0 100,100"></polygon>
      </svg>

      <div class="links" [ngClass]="{ 'is-open': isNavbarOpen }">
        <a routerLink="/home" class="flex no-underline uppercase text-lg whiteTxt underlineHover">Home</a>
        <a
          *ngIf="isLoggedIn() && getRole() === 'admin'"
          routerLinkActive="active-page"
          ariaCurrentWhenActive="page"
          routerLink="/consultUsers"
          class="flex no-underline uppercase text-lg whiteTxt underlineHover"
          >Menu</a
        >
        <a
          *ngIf="isLoggedIn() && getRole() === 'coordenador'"
          routerLinkActive="active-page"
          ariaCurrentWhenActive="page"
          routerLink="/RecordGoalsUpdate"
          class="flex no-underline uppercase text-lg whiteTxt underlineHover"
          >Menu</a>
        <div class="flex items-center ml-auto gap-4 mr-0 sm:mr-8">
          <a
            *ngIf="!isLoggedIn()"
            routerLink="/login"
            routerLinkActive="active-page"
            ariaCurrentWhenActive="page"
            class="flex no-underline uppercase text-lg whiteTxt underlineHover"
            >Login</a
          >
          <div
            *ngIf="isLoggedIn()"
            class="relative"
            (mouseleave)="isDropdownOpen = false"
          >
            <button 
              class="flex items-center gap-x-1"
              mat-button
              [matMenuTriggerFor]="menu"
              (click)="toggleDropdown()">
              <mat-icon class="icon-login">account_circle</mat-icon>
              <div class="flex flex-col items-start ">
                <span class="text-xl mr-0 sm:mr-10 ">{{ getUserName() }},</span>
                <span class="text-xl mr-0 sm:mr-10">{{ getRole() }}</span>
              </div>
            </button>
          </div>

          <mat-menu
            #menu="matMenu"
            class="menu-custom"
            [overlapTrigger]="false"
          >
            <button mat-menu-item (click)="logout()">
              <mat-icon class="blue-custom">exit_to_app</mat-icon>
              <span class="blue-custom">Logout</span>
            </button>
          </mat-menu>
        </div>


      </div>


      <button
      class="bellIcon_mobile"
      *ngIf="isLoggedIn()"
      (click)="toggleNotifications()"
      matBadgePosition="above after"
      mat-raised-button
      color="primary"
      [matBadge]="unreadNotifications"
      matBadgeColor="warn"
    >
      <img
        src="../../../../assets/images/notificationIcon.png"
        class="w-[35px] cursor-pointer"
        alt="Notifications icon"
      />
    </button>

      <div class="nav-toggle" id="nav-toggle" (click)="openNavBar()">
        <div
          class="hamburger"
          id="hamburger"
          [ngClass]="{ 'is-open': isNavbarOpen }"
        ></div>
      </div>
    </div>
  </header>

  <div
    *ngIf="isNotificationsOpen"
    class="absolute top-10 right-5 text-left z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"
    role="menu"
    aria-orientation="vertical"
    aria-labelledby="menu-button"
    tabindex="-1"
  >
    <div class="py-1" role="none">
      <h2 class="block mb-0 px-4 py-2 text-sm text-gray-700 blue-custom">
        Notifications
      </h2>
      <div
        *ngFor="let notification of allNotifications"
        (click)="markNotificationAsRead(notification)"
        class="px-4 mx-2 py-2 border-b border-gray-200 cursor-pointer"
        [class.unread]="!notification.isRead"
      >
        <div class="flex items-center mb-1">
          <!-- <mat-icon class="mr-2">person</mat-icon> -->
          <p class="text-sm blue-custom">{{ notification.sender }}</p>
        </div>
        <div class="flex items-center mb-1">
          <!-- <mat-icon class="mr-2">title</mat-icon> -->
          <p class="text-sm blue-custom">{{ notification.title }}</p>
        </div>
        <div class="flex items-center">
          <!-- <mat-icon class="mr-2">event</mat-icon> -->
          <p class="text-sm blue-custom">{{ notification.created_at }}</p>
        </div>
      </div>
    </div>
  </div>


</div>


<div class="modal" [ngClass]="{ show: isLoginOut }" >
  <div class=" w-1/2 rounded-xl m-auto mt-20 forms-container">
    <div class="loading-circle_forBlueBG">
      <div class="spinner_forBlueBG"></div>
      <p>A fazer logout...</p>
    </div>
  </div>
</div>








